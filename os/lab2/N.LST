Microsoft (R) Macro Assembler Version 5.10                  10/6/19 17:24:11
                                                             Page     1-1


       1				.386P 
       2				 
       3				descr struc 
       4 0000  0000			limit dw 0 
       5 0002  0000			base_l dw 0 
       6 0004  00			base_m db 0 
       7 0005  00			attr_1 db 0 
       8 0006  00			attr_2 db 0 
       9 0007  00			base_h db 0 
      10 0008				descr ends 
      11				
      12 0000				data segment 
      13				;–¢–∞–±–ª–∏—Ü–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –¥
					–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ GDT 
      14 0000  0000			gdt_null descr <0,0,0,0,0,0> ;Hy–ª–µ–≤o
					–π –¥–µ—Å–∫—Ä–∏n—Ç–æ—Ä 
      15 0002  0000			
      16 0004  00			
      17 0005  00			
      18 0006  00			
      19 0007  00			
      20				
      21 0008  4600			gdt_data descr <data_size-1,0,0,92h> ;C
					e–ª–µ–∫—Ç–æ—Ä 8, —Å–µ–≥–º–µ–Ω—Ç –¥–∞–Ω–
					Ω—ã—Ö 
      22 000A  0000			
      23 000C  00			
      24 000D  92			
      25 000E  00			
      26 000F  00			
      27				
      28 0010  5E01			gdt_code descr <code_size-1,,,98h> ;–°–
					µ–ª–µ–∫—Ç–æ—Ä 16, —Å–µ–≥–º–µ–Ω—Ç –∫–æ–º
					–∞–Ω–¥ 
      29 0012  0000			
      30 0014  00			
      31 0015  98			
      32 0016  00			
      33 0017  00			
      34				
      35 0018  FF00			gdt_stack descr <255,0,0,92h> ;–°–µ–ª–µ
					–∫—Ç–æ—Ä 24, —Å–µ–≥–º–µ–Ω—Ç —Å—Ç–µ–∫–∞ 
      36 001A  0000			
      37 001C  00			
      38 001D  92			
      39 001E  00			
      40 001F  00			
      41				
      42 0020  FF0F			gdt_screen descr <4095,8000h,0Bh,92h> ;
					–°–µ–ª–µ–∫—Ç–æ—Ä 32, –≤–∏–¥–µ–æ–±—É—Ñ–µ
					—Ä 
      43 0022  0080			
      44 0024  0B			
      45 0025  92			
Microsoft (R) Macro Assembler Version 5.10                  10/6/19 17:24:11
                                                             Page     1-2


      46 0026  00			
      47 0027  00			
      48				
      49 = 0028				gdt_size=$-gdt_null
      50				
      51 0028  0000000000000000		pdescr dq 0 ;–ü—Å–µ–≤–¥–æ–¥–µ—Å–∫—Ä–∏n—
					Ç–æ—Ä 
      52 0030  01			sym    db 1
      53 0031  1E			attr   db 1Eh
      54 0032  1B 5B 30 3B 20 52	mes    db 27,'[0; Real mode!',27,'[O$' 
      55       65 61 6C 20 6D 6F	
      56       64 65 21 1B 5B 4F	
      57       24			
      58 0045  00			s      db ?
      59 0046  1E			attr2  db 1Eh
      60 = 0047				data_size=$-gdt_null 
      61 0047				data ends 
      62				
      63 0000				text segment 'code' use16  
      64				assume CS:text,DS:data 
      65 0000				main proc 
      66 0000  66| 33 C0			xor EAX, EAX 
      67 0003  B8 ---- R			mov AX, data 
      68 0006  8E D8				mov DS, AX 
      69					;–í—ã—á–∏—Å–ª–∏–º 32-–±–∏—Ç–æ–≤
					—ã–π –ª–∏–Ω –∞–¥—Ä–µ—Å —Å–µ–≥–º–µ–Ω—Ç–∞
					 –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–≥—Ä—É–∑–∏–º –µ–≥–
					æ
      70					;–≤ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å–µ–≥
					–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã—Ö GDT. 
      71 0008  66| C1 E0 04			shl EAX, 4
      72 000C  66| 8B E8			mov EBP, EAX 
      73 000F  66| BB 0008 R			mov EBX, offset gdt_data
      74 0015  89 47 02				mov [BX].base_l, AX
      75 0018  66| C1 C0 10			rol EAX, 16 
      76 001C  88 47 04				mov [BX].base_m, AL
      77					;–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –ª
					–∏–Ω–µ–π–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤ —Å–µ–≥–º–
					µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥ –∏ —Å—Ç–µ–∫–∞
      78 001F  66| 33 C0			xor EAX, EAX 
      79 0022  8C C8				mov AX, CS
      80 0024  66| C1 E0 04			shl EAX, 4
      81 0028  66| BB 0010 R			mov EBX, offset gdt_code 
      82 002E  89 47 02				mov [BX].base_l, AX
      83 0031  66| C1 C0 10			rol EAX, 16 
      84 0035  88 47 04				mov [BX].base_m, AL 
      85					
      86 0038  66| 33 C0			xor EAX,EAX 
      87 003B  8C D0				mov AX, SS 
      88 003D  66| C1 E0 04			shl EAX, 4 
      89 0041  66| BB 0018 R			mov EBX, offset gdt_stack
      90 0047  89 47 02				mov [BX].base_l, AX
      91 004A  66| C1 C0 10			rol EAX, 16 
      92 004E  88 47 04				mov [BX].base_m, AL
Microsoft (R) Macro Assembler Version 5.10                  10/6/19 17:24:11
                                                             Page     1-3


      93					;–ü–æ–¥–≥–æ—Ç–æ–≤–∏–º –ø—Å–µ–≤–
					¥–æ–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –∏ –∑–∞–≥—Ä—É–∑
					–∏–º —Ä–µ–≥–∏—Å—Ç—Ä GDTR
      94 0051  67| 66| 89 2D 0000		mov dword ptr pdescr+2, EBP
      95       002A R			
      96 0059  67| C7 05 00000028 R		mov word ptr pdescr, gdt_size-1
      97       0027			
      98 0062  67| 0F 01 15 00000028		lgdt pdescr
n.asm(63): warning A4057: Illegal size for operand
      99	R			
     100					;–ü–æ–¥–≥–æ—Ç–æ–≤–∏–º –ø–µ—Ä–µ—
					Ö–æ–¥ –≤ –∑–∞—â–∏—â—ë–Ω–Ω—ã–π —Ä–µ–∂–∏–
					º
     101 006A  FA				cli 
     102 006B  B0 80				mov AL, 80h
     103 006D  E6 70				out 70h, AL
     104					;–ü–µ—Ä–µ—Ö–æ–¥ –≤ –∑–∞—â–∏—â—ë
					–Ω–Ω—ã–π —Ä–µ–∂–∏–º
     105 006F  0F 20 C0				mov EAX, CR0
     106 0072  66| 83 C8 01			or  EAX, 1 ; (56)–£—Å—Ç–∞–Ω–æ–≤
					–∏–º –±–∏—Ç –†–ï
     107 0076  0F 22 C0				mov CR0, EAX 
     108					
     109 0079  EA				db 0EAh 
     110 007A  007E R				dw offset continue
     111 007C  0010				dw 16 ;–°–µ–ª–µ–∫—Ç–æ—Ä —Å–µ–≥–
					º–µ–Ω—Ç–∞ –∫–æ–º–∞–Ω–¥ 
     112					
     113 007E				continue: 
     114					;–î–µ–ª–∞–µ–º –∞–¥—Ä–µ—Å—É–µ–º—
					ã–º–∏ –¥–∞–Ω–Ω—ã–µ –∏ —Å—Ç–µ–∫
     115 007E  B8 0008				mov AX, 8 
     116 0081  8E D8				mov DS, AX
     117					
     118 0083  B8 0018				mov AX, 24
     119 0086  8E D0				mov SS, AX
     120					
     121 0088  B8 0020				mov AX, 32 ;–°–µ–ª–µ–∫—Ç–æ—Ä —Å
					–µr–º–µ–Ω—Ç–∞ –≤–∏–¥–µ–æ–±—É—Ñ–µ—Ä–∞ 
     122 008B  8E C0				mov ES, AX 
     123 008D  BB 0320				mov BX, 800 
     124 0090  B9 0040				mov CX, 64
     125 0093  67| A1 00000030 R		mov AX, word ptr sym
     126					
     127 0099				screen:
     128 0099  26: 89 07			mov ES:[BX], AX
     129 009C  83 C3 02				add BX, 2
     130 009F  40				inc AX
     131 00A0  E2 F7				loop screen
     132					
     133					;–û–ø—Ä–µ–¥–µ–ª–∏–º –æ–±—ä—ë–º 
					–¥–æ—Å—Ç—É–ø–Ω–æ–π —Ñ–∏–∑. –ø–∞–º—è—Ç–∏
     134 00A2				mem:
     135 00A2  66| BB 00100001			mov EBX, 100001h
     136 00A8  B2 49				mov DL, 49h ;—Ä–∞–Ω–¥–æ–º–Ω–æ–µ
Microsoft (R) Macro Assembler Version 5.10                  10/6/19 17:24:11
                                                             Page     1-4


					 –∑–Ω–∞—á–µ–Ω–∏–µ
     137 00AA  66| B9 FFEFFFFE			mov ECX, 0ffeffffeh
     138				
     139 00B0				check_mem:
     140 00B0  67| 8A 33			mov DH, DS:[EBX]
     141 00B3  67| 88 13			mov DS:[EBX], DL ; –∑–∞–ø–∏—Å—å
					 —Å–∏–≥–Ω–∞—Ç—É—Ä—ã
     142 00B6  67| 38 13			cmp DS:[EBX], DL ; —Å—Ä–∞–≤–Ω–µ
					–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã
     143 00B9  0F 85 00C4 R			jne end_mem
     144 00BD  67| 88 33			mov DS:[EBX], DH
     145 00C0  66| 43				inc EBX
     146 00C2  E2 EC				loop check_mem
     147					
     148 00C4				end_mem:
     149 00C4  66| 33 D2			xor EDX, EDX
     150 00C7  66| 8B C3			mov EAX, EBX
     151 00CA  BB 03CC				mov BX, 972
     152 00CD  66| B9 0000000A			mov ECX, 10
     153 00D3				divide:	
     154 00D3  66| F7 F1			div ECX
     155 00D6  66| 83 C2 30			add EDX, '0'
     156 00DA  67| 88 15 00000045 R		mov s, DL
     157 00E1  67| 8B 15 00000045 R		mov DX, word ptr s
     158 00E8  26: 89 17			mov ES:[BX], DX
     159 00EB  83 EB 02				sub BX, 2
     160 00EE  66| BA 00000000			mov EDX, 0
     161 00F4  66| 83 F8 00			cmp EAX, 0
     162 00F8  75 D9				jnz divide
     163					
     164					
     165					;–ü–æ–¥r–æ—Ç–æ–≤–∏–º –ø–µ—Ä–µ—Ö
					–æ–¥ –≤ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º 
     166					;–°—Ñ–æ—Ä–º–∏—Ä—É–µ–º –∏ –∑–∞–≥
					—Ä—É–∑–∏–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –¥–ª—
					è —Ä–µ–∞–ø—å–Ω–ær–æ —Ä–µ–∂–∏–º–∞ 
     167 00FA  67| C7 05 00000008 R		mov gdt_data.limit, 0FFFFh
     168       FFFF			
     169 0103  67| C7 05 00000010 R		mov gdt_code.limit, 0FFFFh
     170       FFFF			
     171 010C  67| C7 05 00000018 R		mov gdt_stack.limit, 0FFFFh
     172       FFFF			
     173 0115  67| C7 05 00000020 R		mov gdt_screen.limit, 0FFFFh
     174       FFFF			
     175					
     176 011E  B8 0008				mov AX, 8 ;–ó–∞–≥—Ä—É–∑–∏–º —Ç–
					µ–Ω–µ–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä 
     177 0121  8E D8				mov DS, AX ;—Å–µ–≥–º–µ–Ω—Ç–∞ –¥
					–∞–Ω–Ω—ã—Ö 
     178 0123  B8 0018				mov AX, 24 ;–ó–∞r—Ä—É–∑–∏–º —Ç–
					µ–Ω–µ–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä 
     179 0126  8E D0				mov SS, AX ;—Å—Ç–µ–∫–∞ 
     180 0128  B8 0020				mov AX, 32 ;–ó–∞–≥—Ä—É–∑–∏–º —Ç
					–µ–Ω–µ–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä 
Microsoft (R) Macro Assembler Version 5.10                  10/6/19 17:24:11
                                                             Page     1-5


     181 012B  8E C0				mov ES, AX ;–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–
					ª—å–Ω–ær–æ —Å–µ–≥–º–µ–Ω—Ç–∞ 
     182				
     183 012D  EA				db 0EAh
     184 012E  0132 R				dw offset go
     185 0130  0010				dw 16 
     186					
     187					;–ü–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–µ–∞–ª—å–Ω
					—ã–π —Ä–µ–∂–∏–º
     188 0132				go: 
     189 0132  0F 20 C0				mov EAX, CR0 
     190 0135  66| 83 E0 FE			and EAX, 0FFFFFFFEh ;–°–±—Ä–æ—Å
					–∏–º –±–∏—Ç P–ï
     191 0139  0F 22 C0				mov CR0, EAX 
     192 013C  EA				db 0EAh 
     193 013D  0141 R				dw offset return
     194 013F  ---- R				dw text 
     195					
     196					; –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–º –æ–ø–µ
					—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å—Ä–µ–¥—É —Ä–µ–∞–ª—
					å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
     197 0141				return: 
     198 0141  B8 ---- R			mov AX, data
     199 0144  8E D8				mov DS, AX
     200 0146  B8 ---- R			mov AX, stk
     201 0149  8E D0				mov SS, AX 
     202				
     203 014B  FB				sti
     204 014C  B0 00				mov AL, 0 
     205 014E  E6 70				out 70h, AL  
     206					
     207 0150  B4 09				mov AH, 09h 
     208 0152  66| BA 0032 R			mov EDX, offset mes
     209 0158  CD 21				int 21h 
     210 015A  B8 4C00				mov AX, 4C00h
     211 015D  CD 21				int 21h 
     212 015F				main endp 
     213				
     214 = 015F				code_size=$-main 
     215 015F				text ends
     216				
     217 0000				stk segment stack 'stack'
     218 0000  0100[				db 256 dup ('^')
     219	   5E			
     220			 ]	
     221				
     222 0100				stk ends 
     223				
     224				end main 
Microsoft (R) Macro Assembler Version 5.10                  10/6/19 17:24:11
                                                             Symbols-1


Structures and Records:

                N a m e                 Width   # fields
                                        Shift   Width   Mask    Initial

DESCR  . . . . . . . . . . . . .  	0008	0006
  LIMIT  . . . . . . . . . . . .  	0000
  BASE_L . . . . . . . . . . . .  	0002
  BASE_M . . . . . . . . . . . .  	0004
  ATTR_1 . . . . . . . . . . . .  	0005
  ATTR_2 . . . . . . . . . . . .  	0006
  BASE_H . . . . . . . . . . . .  	0007

Segments and Groups:

                N a m e         	Size	Length	 Align	Combine Class

DATA . . . . . . . . . . . . . .  	32 Bit	0047	PARA	NONE	
STK  . . . . . . . . . . . . . .  	32 Bit	0100	PARA	STACK	'STACK'
TEXT . . . . . . . . . . . . . .  	16 Bit	015F	PARA	NONE	'CODE'

Symbols:            

                N a m e         	Type	 Value	 Attr

ATTR . . . . . . . . . . . . . .  	L BYTE	0031	DATA
ATTR2  . . . . . . . . . . . . .  	L BYTE	0046	DATA

CHECK_MEM  . . . . . . . . . . .  	L NEAR	00B0	TEXT
CODE_SIZE  . . . . . . . . . . .  	NUMBER	015F	
CONTINUE . . . . . . . . . . . .  	L NEAR	007E	TEXT

DATA_SIZE  . . . . . . . . . . .  	NUMBER	0047	
DIVIDE . . . . . . . . . . . . .  	L NEAR	00D3	TEXT

END_MEM  . . . . . . . . . . . .  	L NEAR	00C4	TEXT

GDT_CODE . . . . . . . . . . . .  	L QWORD	0010	DATA
GDT_DATA . . . . . . . . . . . .  	L QWORD	0008	DATA
GDT_NULL . . . . . . . . . . . .  	L QWORD	0000	DATA
GDT_SCREEN . . . . . . . . . . .  	L QWORD	0020	DATA
GDT_SIZE . . . . . . . . . . . .  	NUMBER	0028	
GDT_STACK  . . . . . . . . . . .  	L QWORD	0018	DATA
GO . . . . . . . . . . . . . . .  	L NEAR	0132	TEXT

MAIN . . . . . . . . . . . . . .  	N PROC	0000	TEXT	Length = 015F
MEM  . . . . . . . . . . . . . .  	L NEAR	00A2	TEXT
MES  . . . . . . . . . . . . . .  	L BYTE	0032	DATA

PDESCR . . . . . . . . . . . . .  	L QWORD	0028	DATA

RETURN . . . . . . . . . . . . .  	L NEAR	0141	TEXT

S  . . . . . . . . . . . . . . .  	L BYTE	0045	DATA
Microsoft (R) Macro Assembler Version 5.10                  10/6/19 17:24:11
                                                             Symbols-2


SCREEN . . . . . . . . . . . . .  	L NEAR	0099	TEXT
SYM  . . . . . . . . . . . . . .  	L BYTE	0030	DATA

@CPU . . . . . . . . . . . . . .  	TEXT  3471		
@FILENAME  . . . . . . . . . . .  	TEXT  n		
@VERSION . . . . . . . . . . . .  	TEXT  510		


    181 Source  Lines
    181 Total   Lines
     40 Symbols

  47408 + 451660 Bytes symbol space free

      1 Warning Errors
      0 Severe  Errors
